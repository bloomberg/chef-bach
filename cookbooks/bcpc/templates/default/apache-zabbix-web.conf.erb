################################################
#
#              Generated by Chef
#
################################################

Listen <%="#{node[:bcpc][:management][:vip]}"%>:<%="#{node[:bcpc][:zabbix][:web_port]}"%>
NameVirtualHost <%="#{node[:bcpc][:management][:ip]}"%>:443

<VirtualHost <%="#{node[:bcpc][:management][:vip]}"%>:<%="#{node[:bcpc][:zabbix][:web_port]}"%> <%="#{node[:bcpc][:management][:ip]}"%>:443>
    ServerName "zabbix.<%="#{node[:bcpc][:domain_name]}"%>"
    DocumentRoot "/usr/share/zabbix"
    SSLEngine on
    SSLCertificateFile <%= "#{node[:bcpc][:ssl][:pem_file]}" %>
    SSLCertificateKeyFile <%= "#{node[:bcpc][:ssl][:key_file]}" %>

    <IfVersion >= 2.4>
      <Location />
        Require all granted
      </Location>
    </IfVersion>

    # Include the Apache configuration packaged by upstream.
    Include "/etc/zabbix/apache.conf"
</VirtualHost>

